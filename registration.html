<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CMS – Registration</title>

<style>
:root{
  --cms-teal:#3a6f78;
  --cms-orange:#f37b20;
  --cms-deep:#0d535f;
  --text:#101315;
  --font: system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;

  --container:1440px;
  --content:980px;

  --brand-orange:#e66a1a;
  --text-white:#ffffff;
  --divider-color:rgba(255,255,255,0.15);
}

*{box-sizing:border-box}
html,body{margin:0}
body{font-family:var(--font); color:var(--text); background:#fff; display: flex; flex-direction: column; min-height: 100vh;}
a{color:inherit; text-decoration:none}
button,input,textarea,select{font-family:inherit}
img{max-width:100%; display:block}

.stage{
  position:relative;
  height:360px;
  overflow:hidden;
  background:#000;
}
.stage img.bg{
  position:absolute; inset:0;
  width:100%; height:100%;
  object-fit:cover;
  transform:scale(1.04);
  filter:saturate(1.05) contrast(1.05);
}
.stage::after{
  content:"";
  position:absolute; inset:0;
  background:linear-gradient(180deg,
    rgba(0,0,0,.42) 0%,
    rgba(0,0,0,.58) 55%,
    rgba(0,0,0,.74) 100%
  );
}

.hero-header{
  position:absolute;
  top:0; left:0; right:0;
  z-index:10;
  color:#fff;
}
.hero-header .inner{
  max-width:var(--container);
  margin:0 auto;
  padding:14px 32px 10px;
}
.header-row{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:18px;
}
.header-left{ display:flex; align-items:center; gap:18px; }
.header-right{
  min-width:260px;
  display:flex; align-items:center; justify-content:flex-end;
  gap:18px; font-size:14px;
}
.burger{
  width:40px;height:40px;
  display:grid; place-items:center;
  background:transparent;
  border:none;
  padding:0;
  cursor:pointer;
}
.icon{
  width:18px;height:18px;
  fill:none;
  stroke:#fff;
  stroke-width:2;
  stroke-linecap:round;
  stroke-linejoin:round;
}
.icon-solid{
  width:18px;height:18px;
  fill:#fff;
}
.logo{display:flex; align-items:center;}
.logo img{display:block; height:44px; width:auto;}
.lang{ display:flex; align-items:center; gap:8px; color:#fff; white-space:nowrap; }

.stage-inner{
  position:relative;
  z-index:2;
  height:100%;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  color:#fff;
  text-align:center;
  padding-top:26px;
}
.stage h1{
  margin:0;
  font-weight:220;
  font-size:52px;
  letter-spacing:.2px;
  text-shadow:0 2px 14px rgba(0,0,0,.55);
}
.stage p{
  margin:12px 0 0;
  font-size:15px;
  opacity:.95;
  max-width:760px;
  padding:0 18px;
  line-height:1.5;
  text-shadow:0 2px 10px rgba(0,0,0,.45);
}

.sticky-header{
  position:fixed;
  top:0; left:0; right:0;
  z-index:1000;
  background:var(--cms-teal);
  transform:translateY(-110%);
  transition:transform .18s ease;
}
.sticky-header.is-on{ transform:translateY(0); }
.sticky-header .inner{
  max-width:var(--container);
  margin:0 auto;
  padding:12px 32px;
  color:#fff;
}

.wrap{
  max-width:var(--content);
  margin:0 auto;
  padding:46px 18px 0;
  width: 100%;
  flex: 1; /* Wypycha stopkę na dół */
}

.card{
  border-radius:20px;
  border:1px solid rgba(0,0,0,.12);
  background:#fff;
  overflow:hidden;
}
.card + .card{ margin-top:22px; }

.card-h{ padding:18px 18px 0; }
.h{
  margin:0;
  font-size:44px;
  font-weight:260;
  letter-spacing:-.5px;
  color:#0f172a;
}
.sub{
  margin:10px 0 0;
  color:#1f2937;
  font-weight:450;
  line-height:1.6;
  max-width:920px;
  font-size:16px;
}
.hr{ border-top:1px solid rgba(0,0,0,.10); margin:16px 0 0; }
.card-b{ padding:16px 18px 18px; }

.notice{
  border-radius:16px;
  border:1px solid rgba(0,0,0,.12);
  background:rgba(13,83,95,.04);
  padding:14px 14px;
  color:#111827;
  line-height:1.6;
  font-weight:450;
}

.form-grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:14px;
}
@media (max-width:900px){
  .form-grid{ grid-template-columns:1fr; }
}

.field{ display:flex; flex-direction:column; gap:6px; }
label{
  font-size:12px;
  letter-spacing:.08em;
  text-transform:uppercase;
  color:rgba(0,0,0,.58);
  font-weight:700;
}
input,select,textarea{
  border:1px solid rgba(0,0,0,.14);
  border-radius:14px;
  padding:12px 12px;
  font-size:14px;
  outline:none;
}
input:focus,select:focus,textarea:focus{
  border-color:rgba(13,83,95,.45);
  box-shadow:0 0 0 4px rgba(13,83,95,.08);
}
textarea{ min-height:120px; resize:vertical; }

.full{ grid-column:1 / -1; }

.pills{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
}
.pill{
  display:inline-flex;
  gap:8px;
  align-items:center;
  border:1px solid rgba(0,0,0,.14);
  border-radius:999px;
  padding:8px 12px;
  background:#fff;
  font-size:13px;
  font-weight:550;
  color:#111827;
}
.pill input{ margin:0; width:16px; height:16px; }

.drop{
  border-radius:18px;
  border:1px dashed rgba(0,0,0,.25);
  background:rgba(13,83,95,.04);
  padding:14px 14px;
}
.drop p{
  margin:0 0 10px;
  color:rgba(0,0,0,.70);
  line-height:1.55;
  font-weight:450;
}
.file-row{ display:flex; gap:10px; flex-wrap:wrap; align-items:center; }
.file-list{ margin-top:10px; display:flex; flex-direction:column; gap:8px; }
.file-pill{
  display:flex;
  justify-content:space-between;
  gap:12px;
  align-items:center;
  padding:10px 12px;
  border-radius:14px;
  border:1px solid rgba(0,0,0,.12);
  background:#fff;
  font-size:13px;
}
.file-pill span{ color:rgba(0,0,0,.70); }

.btn{
  display:inline-flex;
  align-items:center;
  gap:10px;
  padding:12px 16px;
  border-radius:999px;
  font-size:12px;
  border:1px solid transparent;
  font-weight:800;
  letter-spacing:.02em;
  cursor:pointer;
}
.btn-teal{ background:#0b6a78; color:#fff; }
.btn-outline-orange{ background:transparent; color:var(--cms-orange); border-color:var(--cms-orange); }
.btn-ghost{ background:rgba(13,83,95,.06); color:#0d535f; border-color:rgba(13,83,95,.18); }

.actions{
  display:flex;
  justify-content:flex-end;
  gap:12px;
  flex-wrap:wrap;
  margin-top:16px;
}

.small{
  font-size:12px;
  color:rgba(0,0,0,.62);
  line-height:1.55;
}

/* MODAL */
.modal-backdrop{
  position:fixed;
  top:0; left:0; right:0; bottom:0;
  background:rgba(0,0,0,0.6);
  z-index:2000;
  display:none;
  align-items:center;
  justify-content:center;
  padding:20px;
  opacity:0;
  transition:opacity 0.2s ease;
}
.modal-backdrop.is-open{
  display:flex;
  opacity:1;
}
.modal{
  background:#fff;
  border-radius:20px;
  max-width:460px;
  width:100%;
  padding:32px;
  text-align:center;
  box-shadow:0 10px 40px rgba(0,0,0,0.3);
  transform:scale(0.95);
  transition:transform 0.2s ease;
}
.modal-backdrop.is-open .modal{
  transform:scale(1);
}
.modal h3{
  margin:0 0 16px;
  font-size:24px;
  font-weight:300;
  color:#0f172a;
}
.modal p{
  margin:0 0 24px;
  color:#1f2937;
  line-height:1.55;
  font-size:15px;
}
.modal-actions{
  display:flex;
  flex-direction:column;
  gap:12px;
  align-items:stretch;
}
.modal-actions .btn{
  justify-content:center;
  width:100%;
}

/* ================= STOPKA (Style z index.html) ================= */
.cms-footer{
  margin-top:70px;
  background-color: #115e6e;
  background-image: radial-gradient(
    ellipse 180% 130% at 50% -30%,
    #022228 10%,
    #06313a 40%,
    transparent 85%
  );
  color: var(--text-white);
  padding: 0;
  width: 100%;
  flex-shrink: 0;
}

.footer-centered-wrap {
  max-width: var(--container);
  margin: 0 auto;
  padding: 60px 40px 30px;
  min-height: 650px;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
}

.breadcrumbs {
  font-size: 11px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 1px;
  margin-bottom: 80px;
  display: flex;
  align-items: center;
  gap: 10px;
  opacity: 0.8;
}
.breadcrumbs .sep { font-size: 10px; }

.main-content {
  display: flex;
  align-items: stretch;
  flex-grow: 1;
}

.left-col {
  flex: 0 0 50%;
  max-width: 50%;
  padding-right: 60px;
}

.middle-line {
  width: 1px;
  background-color: var(--divider-color);
  opacity: 0.5;
  flex-shrink: 0;
}

.right-col {
  flex: 0 0 50%;
  max-width: 50%;
  padding-left: 100px;
}

.logo-c { margin-bottom: 50px; }
.logo-c img{ width:90px; height:90px; display:block; }

.left-col h2 {
  font-size: 56px;
  font-weight: 350;
  margin: 0 0 30px 0;
  letter-spacing: -1px;
}
.left-col p {
  font-size: 20px;
  line-height: 1.5;
  margin-bottom: 50px;
  font-weight: 300;
  opacity: 0.9;
}
.btn-orange {
  background-color: var(--brand-orange);
  color: white;
  padding: 18px 38px;
  border-radius: 40px;
  text-decoration: none;
  font-weight: 700;
  font-size: 14px;
  display: inline-flex;
  align-items: center;
  text-transform: uppercase;
  letter-spacing: 1px;
}
.btn-orange:after {
  content: "→";
  margin-left: 12px;
  font-size: 20px;
  font-weight: 300;
}
.social {
  margin-top: 80px;
  display: flex;
  gap: 30px;
  font-size: 16px;
  font-weight: 400;
}
.social a { color: white; text-decoration: none; }

.footer-nav { list-style: none; padding: 0; margin: 0; }
.footer-nav li { margin-bottom: 15px; }
.footer-nav a {
  color: white;
  text-decoration: none;
  font-size: 44px;
  font-weight: 300;
  line-height: 1.1;
  display: block;
}

.bottom-bar {
  margin-top: 60px;
  border-top: 1px solid rgba(255,255,255,0.1);
  padding-top: 30px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-size: 12px;
  letter-spacing: 1px;
  font-weight: 600;
  gap:20px;
  flex-wrap:wrap;
}
.bottom-left-group {
  display: flex;
  align-items: center;
  gap: 40px;
}
.a11y-icon {
  width: 36px;
  height: 36px;
  border: 2px solid white;
  border-radius: 50%;
  display: flex;
  justify-content: center;
  align-items: center;
}
.legal-links {
  display: flex;
  gap: 20px;
  text-transform: uppercase;
  flex-wrap:wrap;
}
.legal-links a { color: white; text-decoration: none; opacity: 0.8; }

.scroll-up {
  background-color: var(--brand-orange);
  width: 48px;
  height: 48px;
  border-radius: 50%;
  display: flex;
  justify-content: center;
  align-items: center;
  cursor: pointer;
  border: none;
}

/* BACK TOP BTN */
.back-top{
  position:fixed;
  right:28px;
  bottom:28px;
  width:52px;
  height:52px;
  border-radius:999px;
  background:var(--cms-orange);
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:1100;
  opacity:0;
  pointer-events:none;
  transform:translateY(10px);
  transition:opacity .18s ease, transform .18s ease;
}
.back-top.is-on{
  opacity:1;
  pointer-events:auto;
  transform:translateY(0);
}
.back-top svg{
  width:22px;
  height:22px;
  fill:none;
  stroke:#fff;
  stroke-width:3;
  stroke-linecap:round;
  stroke-linejoin:round;
}

/* MEDIA QUERIES DLA STOPKI */
@media (max-width:980px){
  .cms-footer { margin-top:40px; }
  .footer-centered-wrap { padding: 40px 24px 24px; min-height:auto; }
  .main-content{ flex-direction:column; gap:34px; }
  .left-col { flex: auto; max-width: 100%; padding-right: 0; }
  .right-col { flex: auto; max-width: 100%; padding-left: 0; }
  .middle-line{ display:none; }
  .footer-nav a{ font-size:34px; }
}
</style>
</head>

<body>

<section class="stage" id="hero">
  <img class="bg" alt="" src="photocms_register_hero.jpg">

  <header class="hero-header" aria-label="Header on hero">
    <div class="inner">
      <div class="header-row">
        <div class="header-left">
          <button class="burger" aria-label="Menu">
            <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
              <path d="M4 6h16M4 12h16M4 18h16"></path>
            </svg>
          </button>

          <a class="logo" href="Stronastazowa.html" aria-label="Back to Virtual internships">
            <img src="cms%20logo.png" alt="CMS law·tax·future">
          </a>
        </div>

        <div class="header-right">
          <div class="lang">
            <svg class="icon-solid" viewBox="0 0 24 24" aria-hidden="true">
              <path d="M12 22s7-6.2 7-13a7 7 0 0 0-14 0c0 6.8 7 13 7 13z"></path>
              <circle cx="12" cy="9" r="2.6" fill="#0d535f"></circle>
            </svg>
            <span>Poland | EN</span>
          </div>

          <button class="burger" aria-label="Search">
            <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
              <circle cx="11" cy="11" r="6.5"></circle>
              <path d="M16.2 16.2L21 21"></path>
            </svg>
          </button>
        </div>
      </div>
    </div>
  </header>

  <div class="stage-inner">
    <h1>Register to continue</h1>
    <p>
      Before you jump into our virtual internships, please create your profile. This helps to tailor the experience to your needs.
    </p>
  </div>
</section>

<header class="sticky-header" id="sticky" aria-label="Sticky header">
  <div class="inner">
    <div class="header-row">
      <div class="header-left" style="display:flex; align-items:center; gap:18px;">
        <button class="burger" aria-label="Menu">
          <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
            <path d="M4 6h16M4 12h16M4 18h16"></path>
          </svg>
        </button>
        <a class="logo" href="Stronastazowa.html" aria-label="Back">
          <img src="cms%20logo.png" alt="CMS law·tax·future">
        </a>
      </div>

      <div class="header-right">
        <div class="lang">
          <svg class="icon-solid" viewBox="0 0 24 24" aria-hidden="true">
            <path d="M12 22s7-6.2 7-13a7 7 0 0 0-14 0c0 6.8 7 13 7 13z"></path>
            <circle cx="12" cy="9" r="2.6" fill="#0d535f"></circle>
          </svg>
          <span>Poland | EN</span>
        </div>
        <button class="burger" aria-label="Search">
          <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
            <circle cx="11" cy="11" r="6.5"></circle>
            <path d="M16.2 16.2L21 21"></path>
          </svg>
        </button>
      </div>
    </div>
  </div>
</header>

<main class="wrap">
  <article class="card">
    <div class="card-h">
      <h2 class="h">Your profile</h2>
      <p class="sub">
        Fill in your details below. Everything you enter and can be updated later. (TEST)
      </p>
      <div class="hr"></div>
    </div>

    <div class="card-b">
      <div class="notice">
        <b>Note:</b> This is a demo registration flow. Data is stored locally in your browser (LocalStorage).
      </div>

      <form id="regForm" style="margin-top:16px;">
        <div class="form-grid">
          <div class="field">
            <label for="firstName">First name</label>
            <input id="firstName" name="firstName" value="Jan" required>
          </div>
          <div class="field">
            <label for="lastName">Last name</label>
            <input id="lastName" name="lastName" value="Kowalski" required>
          </div>

          <div class="field">
            <label for="email">Email</label>
            <input id="email" name="email" type="email" value="jan.kowalski@example.com" required>
          </div>
          <div class="field">
            <label for="phone">Phone (optional)</label>
            <input id="phone" name="phone" value="+48 600 100 200">
          </div>

          <div class="field">
            <label for="studentStatus">Are you a student?</label>
            <select id="studentStatus" name="studentStatus">
              <option value="yes" selected>Yes</option>
              <option value="no">No</option>
            </select>
          </div>
          <div class="field">
            <label for="city">City / country</label>
            <input id="city" name="city" value="Warsaw, Poland">
          </div>

          <div class="field">
            <label for="school">School / university</label>
            <input id="school" name="school" value="Warsaw University">
          </div>
          <div class="field">
            <label for="degree">Degree / programme</label>
            <input id="degree" name="degree" value="Law (LL.B.)">
          </div>

          <div class="field">
            <label for="year">Year of study</label>
            <select id="year" name="year">
              <option>1</option><option>2</option><option selected>3</option><option>4</option><option>5</option><option>Graduate</option>
            </select>
          </div>
          <div class="field">
            <label for="availability">Availability</label>
            <select id="availability" name="availability">
              <option selected>Immediately</option>
              <option>In 1 month</option>
              <option>In 3 months</option>
              <option>Other</option>
            </select>
          </div>

          <div class="field full">
            <label>Interests</label>
            <div class="pills">
              <label class="pill"><input type="checkbox" name="interests" value="Energy" checked> Energy</label>
              <label class="pill"><input type="checkbox" name="interests" value="Employment"> Employment</label>
              <label class="pill"><input type="checkbox" name="interests" value="M&A"> M&A</label>
              <label class="pill"><input type="checkbox" name="interests" value="Disputes"> Disputes</label>
              <label class="pill"><input type="checkbox" name="interests" value="IP/Tech"> IP/Tech</label>
            </div>
          </div>

          <div class="field">
            <label for="languages">Languages</label>
            <input id="languages" name="languages" value="Polish (native), English (C1)">
          </div>
          <div class="field">
            <label for="experienceLevel">Experience level</label>
            <select id="experienceLevel" name="experienceLevel">
              <option selected>0–1 years</option>
              <option>1–2 years</option>
              <option>2–4 years</option>
              <option>4+ years</option>
            </select>
          </div>

          <div class="field">
            <label for="lastRole">Most recent experience</label>
            <input id="lastRole" name="lastRole" value="Student intern">
          </div>
          <div class="field">
            <label for="lastRoleDesc">What did you do?</label>
            <input id="lastRoleDesc" name="lastRoleDesc" value="Drafting notes, research.">
          </div>

          <div class="field full">
            <label for="links">Links (LinkedIn / portfolio)</label>
            <input id="links" name="links" value="https://linkedin.com/in/abcd">
          </div>

          <div class="field full">
            <label for="motivation">Why are you interested?</label>
            <textarea id="motivation" name="motivation">I want to learn.</textarea>
          </div>

          <div class="field full">
            <label>CV upload</label>
            <div class="drop" id="drop">
              <p><b>Upload CV</b> (drag & drop or choose). Stored locally.</p>
              <div class="file-row">
                <input id="cvInput" type="file" accept=".pdf,.doc,.docx">
                <button class="btn btn-ghost" id="clearCv" type="button">Clear</button>
              </div>
              <div class="file-list" id="cvList"></div>
            </div>
          </div>

          <div class="field full">
            <label>Consents</label>
            <div class="pills">
              <label class="pill"><input type="checkbox" id="consent1" checked required> I confirm the information is accurate (TEST).</label>
              <label class="pill"><input type="checkbox" id="consent2" checked> I agree to be contacted about opportunities (TEST).</label>
            </div>
          </div>
        </div>

        <div class="actions">
          <a class="btn btn-ghost" id="backBtn" href="Stronastazowa.html">Back</a>
          <button class="btn btn-outline-orange" id="saveDraft" type="button">Save draft</button>
          <button class="btn btn-teal" type="submit">Register & continue →</button>
        </div>

        <p class="small" style="margin-top:10px;">
          Next step: <b id="nextLabel"></b>
        </p>
      </form>
    </div>
  </article>
</main>

<footer class="cms-footer" id="footer">
  <div class="footer-centered-wrap">
    <div class="breadcrumbs">
      HOME <span class="sep">&gt;</span> CAREERS
    </div>

    <div class="main-content">
      <div class="left-col">
        <div class="logo-c">
          <img src="cms%20C%20logo.png" alt="CMS C logo">
        </div>

        <h2>Stay informed</h2>
        <p>For the very latest legal updates, commentary, and analysis from CMS delivered directly to your inbox, sign up to the Law-Now subscription service now.</p>

        <a href="#" class="btn-orange">SIGN UP NOW</a>

        <div class="social">
          <a href="#">LinkedIn</a>
          <a href="#">X</a>
        </div>
      </div>

      <div class="middle-line"></div>

      <div class="right-col">
        <ul class="footer-nav">
          <li><a href="#">Home</a></li>
          <li><a href="#">Expertise</a></li>
          <li><a href="#">People</a></li>
          <li><a href="#">Offices</a></li>
          <li><a href="#">Insights</a></li>
          <li><a href="#">Innovation</a></li>
          <li><a href="#">About us</a></li>
        </ul>
      </div>
    </div>

    <div class="bottom-bar">
      <div class="bottom-left-group">
        <div class="a11y-icon">
          <svg width="22" height="22" viewBox="0 0 24 24" fill="white" aria-hidden="true">
            <path d="M12 2c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2zm9 7h-6v13h-2v-6h-2v6H9V9H3V7h18v2z"/>
          </svg>
        </div>
        <div>© CMS LEGAL 2026</div>
      </div>

      <div class="legal-links">
        <a href="#">Legal Information</a>
        <a href="#">Privacy Notice</a>
        <a href="#">Cookie Notice</a>
        <a href="#">Terms of Use</a>
        <a href="#">Accessibility</a>
        <a href="#">Contact</a>
        <a href="#">Sitemap</a>
      </div>

      <button class="scroll-up" type="button" aria-label="Scroll to top">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3" aria-hidden="true">
          <path d="M18 15l-6-6-6 6"/>
        </svg>
      </button>
    </div>
  </div>
</footer>

<a class="back-top" id="backTop" href="javascript:void(0)" aria-label="Back to top">
  <svg viewBox="0 0 24 24" aria-hidden="true">
    <path d="M18 15l-6-6-6 6"></path>
  </svg>
</a>

<div class="modal-backdrop" id="modalBackdrop">
  <div class="modal">
    <h3>Check your inbox</h3>
    <p>
      We've sent a verification link to your email address.<br>
      Since this is a mockup, no real email was sent.
    </p>
    <div class="modal-actions">
      <button class="btn btn-teal" type="button" id="modalSkip">Skip verification & continue</button>
    </div>
  </div>
</div>

<script>
(function(){
  const sticky = document.getElementById('sticky');
  const hero = document.getElementById('hero');
  const backTop = document.getElementById('backTop');

  // TU USTAWIASZ NAZWĘ PLIKU NASTĘPNEJ STRONY
  const next = 'energy-welcome.html';
  document.getElementById('nextLabel').textContent = next;

  // KLUCZ POD KTÓRYM ZAPISZEMY DANE (WAŻNE NA KOLEJNYCH STRONACH)
  const PROFILE_KEY = "cms_user_profile_v1";

  const form = document.getElementById('regForm');
  const saveDraftBtn = document.getElementById('saveDraft');

  const cvInput = document.getElementById('cvInput');
  const cvList = document.getElementById('cvList');
  const clearCv = document.getElementById('clearCv');
  const drop = document.getElementById('drop');

  const modalBackdrop = document.getElementById('modalBackdrop');
  const modalSkip = document.getElementById('modalSkip');

  let cvMeta = null;

  function escapeHtml(s){
    return String(s).replace(/[&<>"']/g, m=>({ "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;" }[m]));
  }
  function formatBytes(bytes){
    if(!bytes) return "";
    const k=1024, sizes=["B","KB","MB","GB"];
    const i=Math.floor(Math.log(bytes)/Math.log(k));
    return (bytes/Math.pow(k,i)).toFixed(i?1:0)+" "+sizes[i];
  }

  function renderCv(){
    cvList.innerHTML = "";
    if(!cvMeta){
      const p = document.createElement('div');
      p.className = "small";
      p.textContent = "No CV attached yet.";
      cvList.appendChild(p);
      return;
    }
    const pill = document.createElement('div');
    pill.className = "file-pill";
    pill.innerHTML = `<div><b>${escapeHtml(cvMeta.name)}</b> <span>(${formatBytes(cvMeta.size)})</span></div><span>${escapeHtml(cvMeta.type||"")}</span>`;
    cvList.appendChild(pill);
  }

  function saveProfile(mode){
    const fd = new FormData(form);
    const interests = [];
    form.querySelectorAll('input[name="interests"]:checked').forEach(x=> interests.push(x.value));

    // Tworzenie obiektu danych
    const profile = {
      firstName: (fd.get('firstName')||"").toString(),
      lastName: (fd.get('lastName')||"").toString(),
      email: (fd.get('email')||"").toString(),
      phone: (fd.get('phone')||"").toString(),
      studentStatus: (fd.get('studentStatus')||"").toString(),
      city: (fd.get('city')||"").toString(),
      school: (fd.get('school')||"").toString(),
      degree: (fd.get('degree')||"").toString(),
      year: (fd.get('year')||"").toString(),
      availability: (fd.get('availability')||"").toString(),
      interests,
      languages: (fd.get('languages')||"").toString(),
      experienceLevel: (fd.get('experienceLevel')||"").toString(),
      lastRole: (fd.get('lastRole')||"").toString(),
      lastRoleDesc: (fd.get('lastRoleDesc')||"").toString(),
      links: (fd.get('links')||"").toString(),
      motivation: (fd.get('motivation')||"").toString(),
      cvMeta: cvMeta,
      savedAt: new Date().toISOString(),
      status: mode || "draft"
    };

    // ZAPIS DO LOCALSTORAGE
    localStorage.setItem(PROFILE_KEY, JSON.stringify(profile));
  }

  // Wczytywanie istniejących danych (jeśli ktoś wróci)
  try{
    const existing = JSON.parse(localStorage.getItem(PROFILE_KEY) || "null");
    if(existing && existing.email){
      if(existing.firstName) document.getElementById('firstName').value = existing.firstName;
      if(existing.lastName) document.getElementById('lastName').value = existing.lastName;
      if(existing.email) document.getElementById('email').value = existing.email;
      // ...reszta pól wczytuje się automatycznie jeśli są...
    }
  }catch(e){ console.log("Brak zapisanych danych"); }

  // Zapisz Draft
  saveDraftBtn.addEventListener('click', ()=>{
    saveProfile("draft");
    saveDraftBtn.textContent = "Saved ✓";
    setTimeout(()=> saveDraftBtn.textContent = "Save draft", 900);
  });

  // Rejestracja (Submit)
  form.addEventListener('submit', (e)=>{
    e.preventDefault(); // Blokujemy przeładowanie
    saveProfile("registered"); // Zapisujemy
    modalBackdrop.classList.add('is-open'); // Otwieramy okienko
  });

  // Przejście dalej
  function proceed(){
    location.href = next; // Idziemy do energy-welcome.html
  }
  modalSkip.addEventListener('click', proceed);

  // Obsługa CV (bez zmian)
  cvInput.addEventListener('change', (e)=>{
    const f = e.target.files && e.target.files[0];
    if(!f) return;
    cvMeta = { name:f.name, size:f.size, type:f.type || "" };
    renderCv();
    cvInput.value = "";
  });
  clearCv.addEventListener('click', ()=>{ cvMeta = null; renderCv(); });

  // Efekty scrolla
  function updateUI(){
    const heroBottom = hero.getBoundingClientRect().bottom;
    const afterHero = heroBottom <= 0;
    sticky.classList.toggle('is-on', afterHero);
    backTop.classList.toggle('is-on', afterHero);
  }
  window.addEventListener('scroll', updateUI, {passive:true});
  updateUI();
  backTop.addEventListener('click', (e)=>{ e.preventDefault(); window.scrollTo({top:0, behavior:'smooth'}); });

  // Obsługa przycisku "Scroll up" w stopce
  const btnUp = document.querySelector('.scroll-up');
  if(btnUp){
    btnUp.addEventListener('click', ()=> window.scrollTo({top:0, behavior:'smooth'}));
  }
})();
</script>

</body>
</html>